import{c as F,r as l,j as e,B as h,C as m,v as x,w as u,x as j,s as N,q as _}from"./index-COc_9EsS.js";import{I as c}from"./input-CtDZ1l8n.js";import{L as i}from"./label-Dwl52tZZ.js";import{T as I,a as A,b as y,c as d,d as E,e as o}from"./table-BBQAnNUa.js";import{R as P}from"./refresh-cw-DDwdgVYR.js";import{S as H}from"./search-_tnmDF7W.js";import{P as R}from"./plus-DarcKYWw.js";import{P as z}from"./pencil-CLmt3uQu.js";import{T as L}from"./trash-2-CCkRIFkE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=F("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),W=()=>{const[b,C]=l.useState([]),[k,f]=l.useState(!0),[w,B]=l.useState(""),[D,g]=l.useState(!1),[s,r]=l.useState({company_id:"",account_holder_name:"",account_number:"",ifsc_code:"",bank_name:"",branch_name:"",upi_id:""}),p=async()=>{try{f(!0);const{data:a,error:t}=await N.from("civora_nexus_bank_details").select("*").order("created_at",{ascending:!1});if(t)throw t;const v=(a||[]).map(n=>({bank_id:n.bank_id,company_id:n.company_id,account_holder_name:n.account_holder_name,account_number:n.account_number,ifsc_code:n.ifsc_code,bank_name:n.bank_name,branch_name:n.branch_name,upi_id:n.upi_id,created_at:n.created_at}));C(v)}catch(a){console.error("Error fetching bank details:",a),_().toast({title:"Error",description:"Failed to fetch bank details",variant:"destructive"})}finally{f(!1)}};l.useEffect(()=>{p()},[]);const S=async()=>{try{f(!0);const a={bank_id:`BANK_${Date.now()}`,...s},{data:t,error:v}=await N.from("civora_nexus_bank_details").insert([a]).select();if(v)throw v;_().toast({title:"Success",description:"Bank detail created successfully",variant:"default"}),r({company_id:"",account_holder_name:"",account_number:"",ifsc_code:"",bank_name:"",branch_name:"",upi_id:""}),g(!1),p()}catch(a){console.error("Error creating bank detail:",a),_().toast({title:"Error",description:"Failed to create bank detail",variant:"destructive"})}finally{f(!1)}},T=async a=>{try{const{error:t}=await N.from("civora_nexus_bank_details").delete().eq("bank_id",a);if(t)throw t;_().toast({title:"Success",description:"Bank detail deleted successfully",variant:"default"}),p()}catch(t){console.error("Error deleting bank detail:",t),_().toast({title:"Error",description:"Failed to delete bank detail",variant:"destructive"})}};return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loader"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(U,{className:"h-8 w-8"}),"Bank Details"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage company bank details"})]}),e.jsxs(h,{onClick:p,variant:"outline",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(m,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium",children:"Total Bank Accounts"})}),e.jsx(j,{children:e.jsx("div",{className:"text-2xl font-bold",children:b.length})})]}),e.jsxs(m,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium",children:"Unique Banks"})}),e.jsx(j,{children:e.jsx("div",{className:"text-2xl font-bold",children:new Set(b.map(a=>a.bank_name).filter(Boolean)).size})})]}),e.jsxs(m,{children:[e.jsx(x,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium",children:"UPI Enabled"})}),e.jsx(j,{children:e.jsx("div",{className:"text-2xl font-bold",children:b.filter(a=>a.upi_id).length})})]})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{children:"All Bank Details"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(c,{placeholder:"Search bank details...",value:w,onChange:a=>B(a.target.value),className:"pl-10 w-64"})]}),e.jsxs(h,{onClick:()=>g(!0),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add New"]})]})]})}),e.jsx(j,{children:e.jsxs(I,{children:[e.jsx(A,{children:e.jsxs(y,{children:[e.jsx(d,{children:"Account Holder"}),e.jsx(d,{children:"Bank Name"}),e.jsx(d,{children:"Account Number"}),e.jsx(d,{children:"IFSC Code"}),e.jsx(d,{children:"UPI ID"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(E,{children:b.map(a=>e.jsxs(y,{children:[e.jsx(o,{className:"font-medium",children:a.account_holder_name}),e.jsx(o,{children:a.bank_name}),e.jsx(o,{children:a.account_number}),e.jsx(o,{children:a.ifsc_code}),e.jsx(o,{children:a.upi_id}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:"outline",size:"sm",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>T(a.bank_id),children:e.jsx(L,{className:"h-4 w-4"})})]})})]},a.bank_id))})]})})]}),D&&e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(u,{children:"Add New Bank Detail"})}),e.jsx(j,{children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"company_id",children:"Company ID"}),e.jsx(c,{id:"company_id",value:s.company_id,onChange:a=>r({...s,company_id:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"account_holder_name",children:"Account Holder Name"}),e.jsx(c,{id:"account_holder_name",value:s.account_holder_name,onChange:a=>r({...s,account_holder_name:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"bank_name",children:"Bank Name"}),e.jsx(c,{id:"bank_name",value:s.bank_name,onChange:a=>r({...s,bank_name:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"account_number",children:"Account Number"}),e.jsx(c,{id:"account_number",value:s.account_number,onChange:a=>r({...s,account_number:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"ifsc_code",children:"IFSC Code"}),e.jsx(c,{id:"ifsc_code",value:s.ifsc_code,onChange:a=>r({...s,ifsc_code:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"branch_name",children:"Branch Name"}),e.jsx(c,{id:"branch_name",value:s.branch_name,onChange:a=>r({...s,branch_name:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"upi_id",children:"UPI ID"}),e.jsx(c,{id:"upi_id",value:s.upi_id,onChange:a=>r({...s,upi_id:a.target.value})})]}),e.jsx(h,{onClick:S,disabled:k,children:k?"Creating...":"Create Bank Detail"})]})})]})]})};export{W as default};
