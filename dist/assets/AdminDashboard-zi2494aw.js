import{c as pe,j as e,C as N,x as w,v as D,w as R,y as U,r as b,q as B,s as T,B as _,af as Y,ag as W,ah as X,ai as G,aj as Q,ak as Z,al as ee,am as se,an as te,E as je,ac as M}from"./index-COc_9EsS.js";import{B as $}from"./badge-jxMiL_t9.js";import{T as fe,a as ge,b as O}from"./tabs-1zC5oSz6.js";import{L as q}from"./Loading-B8USftwP.js";import{D as I}from"./database-BJQ-1OGV.js";import{U as le}from"./users-CStnP4Kw.js";import{T as ve}from"./trending-up-BAW7o3Tz.js";import{A as be}from"./activity-CTQY0Fpa.js";import{B as ye}from"./building-2-9KbUser1.js";import{F as de}from"./file-text-BWAGHgaU.js";import{C as _e}from"./calendar-CSB8LMDL.js";import{I as Ne}from"./input-CtDZ1l8n.js";import"./textarea-CqUjQhD9.js";import{C as ae}from"./checkbox-DYpv0rMu.js";import{T as we,a as Ce,b as re,c as V,d as Se,e as H}from"./table-BBQAnNUa.js";import{A as Te}from"./arrow-left-Bexv0Ci3.js";import{P as De}from"./plus-DarcKYWw.js";import{D as z}from"./download-CpAEjvKm.js";import{T as ne}from"./trash-2-CCkRIFkE.js";import{S as Re}from"./search-_tnmDF7W.js";import{S as ke}from"./square-pen-hqvfta-z.js";import{E as Ae}from"./eye-BWg0lIGw.js";import{R as ie,B as Ee,C as Fe,X as Le,Y as Ue,T as ce,a as $e,P as qe,b as Oe,c as ze}from"./PieChart-EB9GDdoi.js";import{R as Be}from"./refresh-cw-DDwdgVYR.js";import"./index-DUvJja7M.js";import"./index-CUsEfDx6.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=pe("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),Me=({tables:c,loading:v})=>{if(v)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[...Array(4)].map((s,t)=>e.jsx(N,{children:e.jsx(w,{className:"p-6",children:e.jsx(q,{size:"sm",className:"min-h-[60px]"})})},t))});const r=c.reduce((s,t)=>s+t.totalCount,0),l=c.length,x=c.filter(s=>s.totalCount>0).length,a=["profiles","employees","interns"].reduce((s,t)=>{const o=c.find(f=>f.name===t);return s+((o==null?void 0:o.totalCount)||0)},0);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs(N,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Total Records"}),e.jsx(I,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Across ",l," tables"]})]})]}),e.jsxs(N,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Users & Staff"}),e.jsx(le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Profiles, employees, interns"})]})]}),e.jsxs(N,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"Active Tables"}),e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:x}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tables with data"})]})]}),e.jsxs(N,{children:[e.jsxs(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(R,{className:"text-sm font-medium",children:"System Status"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(w,{children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx($,{variant:"default",className:"bg-green-100 text-green-800",children:"Online"})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"All systems operational"})]})]})]})},oe=({tables:c,loading:v})=>{if(v)return e.jsx(q,{size:"md",className:"min-h-[200px]"});const r={users:{title:"User Management",description:"User accounts, profiles, and authentication",icon:le,tables:["profiles","admin_logs","otp_verifications"]},company:{title:"Company Data",description:"Company information and business data",icon:ye,tables:["civora_nexus_companies","civora_nexus_company_contacts","civora_nexus_company_addresses"]},forms:{title:"Form Submissions",description:"Various form submissions and inquiries",icon:de,tables:["contact_submissions","consultation_requests","collaboration_requests"]},support:{title:"Support & Communications",description:"Customer support and communications",icon:Pe,tables:["support_tickets","scheduled_calls","email_history"]},events:{title:"Events & Applications",description:"Events and recruitment applications",icon:_e,tables:["upcoming_events","event_registrations","applications"]},system:{title:"System Management",description:"System administration and maintenance",icon:I,tables:["recycle_bin"]}},l=x=>x.reduce((h,a)=>{const s=c.find(t=>t.name===a);return h+((s==null?void 0:s.totalCount)||0)},0);return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(r).map(([x,h])=>{const a=l(h.tables),s=h.icon;return e.jsxs(N,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(D,{className:"pb-2",children:[e.jsxs(R,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(s,{className:"h-4 w-4 text-primary"}),h.title]}),e.jsx(U,{className:"text-xs",children:h.description})]}),e.jsxs(w,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[h.tables.length," tables"]})]})]},x)})})},Ve=({tableName:c,displayName:v,onBack:r})=>{const[l,x]=b.useState([]),[h,a]=b.useState([]),[s,t]=b.useState(!0),[o,f]=b.useState([]),[S,i]=b.useState(null),[d,p]=b.useState(!1),[u,j]=b.useState(""),[g,L]=b.useState(1),[k]=b.useState(20),{toast:y}=B();b.useEffect(()=>{P()},[c,g,u]);const P=async()=>{try{t(!0);let n=T.from(c).select("*");const m=(g-1)*k,A=m+k-1;n=n.range(m,A);const{data:C,error:F}=await n;if(F)throw F;x(C||[]),C&&C.length>0&&a(Object.keys(C[0]))}catch(n){y({title:"Error",description:n.message,variant:"destructive"})}finally{t(!1)}},ue=async n=>{try{const{error:m}=await T.from(c).delete().eq("id",n);if(m)throw m;y({title:"Success",description:"Record deleted successfully",variant:"default"}),P()}catch(m){y({title:"Error",description:m.message,variant:"destructive"})}},xe=async()=>{try{const{error:n}=await T.from(c).delete().in("id",o);if(n)throw n;y({title:"Success",description:`${o.length} records deleted successfully`,variant:"default"}),f([]),P()}catch(n){y({title:"Error",description:n.message,variant:"destructive"})}},K=async n=>{try{const{data:m,error:A}=await T.from(c).select("*");if(A)throw A;if(n==="csv"){const C=he(m||[]);J(C,`${c}.csv`,"text/csv")}else if(n==="json"){const C=JSON.stringify(m,null,2);J(C,`${c}.json`,"application/json")}y({title:"Success",description:`Data exported as ${n.toUpperCase()}`,variant:"default"})}catch(m){y({title:"Error",description:m.message,variant:"destructive"})}},he=n=>{if(n.length===0)return"";const m=Object.keys(n[0]);return[m.join(","),...n.map(C=>m.map(F=>{const E=C[F];return typeof E=="string"?`"${E.replace(/"/g,'""')}"`:E}).join(","))].join(`
`)},J=(n,m,A)=>{const C=new Blob([n],{type:A}),F=URL.createObjectURL(C),E=document.createElement("a");E.href=F,E.download=m,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(F)};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(_,{variant:"outline",onClick:r,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:v}),e.jsxs("p",{className:"text-muted-foreground",children:[l.length," records"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(_,{onClick:()=>p(!0),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Add Record"]}),e.jsxs(_,{variant:"outline",onClick:()=>K("csv"),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),e.jsxs(_,{variant:"outline",onClick:()=>K("json"),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Export JSON"]}),o.length>0&&e.jsxs(Y,{children:[e.jsx(W,{asChild:!0,children:e.jsxs(_,{variant:"destructive",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Delete Selected (",o.length,")"]})}),e.jsxs(X,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Delete Selected Records"}),e.jsxs(Z,{children:["Are you sure you want to delete ",o.length," records? This action cannot be undone."]})]}),e.jsxs(ee,{children:[e.jsx(se,{children:"Cancel"}),e.jsx(te,{onClick:xe,children:"Delete"})]})]})]})]})]}),e.jsx(N,{children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ne,{placeholder:"Search records...",value:u,onChange:n=>j(n.target.value),className:"pl-10"})]})})}),e.jsx(N,{children:e.jsx(w,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsxs(re,{children:[e.jsx(V,{className:"w-12",children:e.jsx(ae,{checked:o.length===l.length&&l.length>0,onCheckedChange:n=>{f(n?l.map(m=>m.id):[])}})}),h.slice(0,6).map(n=>e.jsx(V,{children:n.replace(/_/g," ").toUpperCase()},n)),e.jsx(V,{className:"text-right",children:"Actions"})]})}),e.jsx(Se,{children:l.map(n=>e.jsxs(re,{children:[e.jsx(H,{children:e.jsx(ae,{checked:o.includes(n.id),onCheckedChange:m=>{f(m?[...o,n.id]:o.filter(A=>A!==n.id))}})}),h.slice(0,6).map(m=>e.jsx(H,{children:typeof n[m]=="boolean"?e.jsx($,{variant:n[m]?"default":"secondary",children:n[m]?"Yes":"No"}):String(n[m]||"-").slice(0,50)},m)),e.jsx(H,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(_,{size:"sm",variant:"outline",onClick:()=>i(n),children:e.jsx(ke,{className:"h-3 w-3"})}),e.jsxs(Y,{children:[e.jsx(W,{asChild:!0,children:e.jsx(_,{size:"sm",variant:"destructive",children:e.jsx(ne,{className:"h-3 w-3"})})}),e.jsxs(X,{children:[e.jsxs(G,{children:[e.jsx(Q,{children:"Delete Record"}),e.jsx(Z,{children:"Are you sure you want to delete this record? This action cannot be undone."})]}),e.jsxs(ee,{children:[e.jsx(se,{children:"Cancel"}),e.jsx(te,{onClick:()=>ue(n.id),children:"Delete"})]})]})]})]})})]},n.id))})]})})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(g-1)*k+1," to ",Math.min(g*k,l.length)," of ",l.length," results"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>L(Math.max(1,g-1)),disabled:g===1,children:"Previous"}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>L(g+1),disabled:l.length<k,children:"Next"})]})]})]})},He=({tables:c,loading:v})=>{const[r,l]=b.useState(null),[x,h]=b.useState("");if(r)return e.jsx(Ve,{tableName:r,displayName:x,onBack:()=>{l(null),h("")}});if(v)return e.jsx(q,{size:"md",className:"min-h-[200px]"});const a=t=>{const o=t.replace(/_/g," ").replace(/civora nexus /,"").split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1)).join(" ");l(t),h(o)},s=[...c].sort((t,o)=>o.totalCount-t.totalCount);return e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(t=>e.jsxs(N,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(D,{className:"pb-2",children:[e.jsxs(R,{className:"text-sm font-medium flex items-center justify-between",children:[e.jsx("span",{className:"truncate",children:t.name.replace(/_/g," ").replace(/civora nexus /,"")}),e.jsx($,{variant:"secondary",className:"ml-2",children:t.totalCount})]}),e.jsxs(U,{className:"text-xs",children:[t.columns.length," columns • ",t.totalCount," records"]})]}),e.jsx(w,{className:"space-y-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{size:"sm",variant:"outline",onClick:()=>a(t.name),className:"flex-1",children:[e.jsx(Ae,{className:"h-3 w-3 mr-1"}),"View"]}),e.jsxs(_,{size:"sm",variant:"outline",disabled:t.totalCount===0,children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),"Export"]})]})})]},t.name))})})},Ie=({tables:c,loading:v})=>{if(v)return e.jsx(q,{size:"md",className:"min-h-[400px]"});const r=c.filter(a=>a.totalCount>0).map(a=>({name:a.name.replace(/_/g," ").replace(/civora nexus /,""),count:a.totalCount,fullName:a.name})).sort((a,s)=>s.count-a.count).slice(0,10),l=[{name:"User Management",value:["profiles","admin_logs","otp_verifications"].reduce((a,s)=>{const t=c.find(o=>o.name===s);return a+((t==null?void 0:t.totalCount)||0)},0),color:"#8884d8"},{name:"Company Data",value:["civora_nexus_companies","civora_nexus_company_contacts","civora_nexus_company_addresses"].reduce((a,s)=>{const t=c.find(o=>o.name===s);return a+((t==null?void 0:t.totalCount)||0)},0),color:"#82ca9d"},{name:"Form Submissions",value:["contact_submissions","consultation_requests","collaboration_requests"].reduce((a,s)=>{const t=c.find(o=>o.name===s);return a+((t==null?void 0:t.totalCount)||0)},0),color:"#ffc658"}].filter(a=>a.value>0),x=c.reduce((a,s)=>a+s.totalCount,0),h=c.filter(a=>a.totalCount>0).length;return e.jsxs("div",{className:"space-y-6",children:[r.length>0&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(N,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Top Tables by Record Count"}),e.jsx(U,{children:"Tables with the most data entries"})]}),e.jsx(w,{children:e.jsx(ie,{width:"100%",height:250,children:e.jsxs(Ee,{data:r,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Fe,{strokeDasharray:"3 3"}),e.jsx(Le,{dataKey:"name",tick:{fontSize:10},angle:-45,textAnchor:"end",height:60}),e.jsx(Ue,{}),e.jsx(ce,{}),e.jsx($e,{dataKey:"count",fill:"#8884d8"})]})})})]}),l.length>0&&e.jsxs(N,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Data Distribution"}),e.jsx(U,{children:"Records by category"})]}),e.jsx(w,{children:e.jsx(ie,{width:"100%",height:250,children:e.jsxs(qe,{children:[e.jsx(Oe,{data:l,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:a,percent:s})=>`${a} (${(s*100).toFixed(0)}%)`,children:l.map((a,s)=>e.jsx(ze,{fill:a.color},`cell-${s}`))}),e.jsx(ce,{})]})})})]})]}),e.jsxs(N,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"System Overview"}),e.jsx(U,{children:"Key statistics"})]}),e.jsx(w,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:x.toLocaleString()}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Records"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:c.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Tables"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:h}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Tables with Data"})]})]})})]})]})},Ke=({tables:c,loading:v})=>{const{toast:r}=B();if(v)return e.jsx(q,{size:"md",className:"min-h-[200px]"});const l=async(s,t)=>{try{const{data:o,error:f}=await T.from(s).select("*");if(f)throw f;if(t==="csv"){const S=x(o||[]);h(S,`${s}.csv`,"text/csv")}else if(t==="json"){const S=JSON.stringify(o,null,2);h(S,`${s}.json`,"application/json")}r({title:"Export Complete",description:`${s} exported as ${t.toUpperCase()}`,variant:"default"})}catch(o){r({title:"Export Failed",description:o.message,variant:"destructive"})}},x=s=>{if(s.length===0)return"";const t=Object.keys(s[0]);return[t.join(","),...s.map(f=>t.map(S=>{const i=f[S];return typeof i=="string"?`"${i.replace(/"/g,'""')}"`:i}).join(","))].join(`
`)},h=(s,t,o)=>{const f=new Blob([s],{type:o}),S=URL.createObjectURL(f),i=document.createElement("a");i.href=S,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(S)},a=c.filter(s=>s.totalCount>0);return e.jsx("div",{className:"space-y-4",children:e.jsxs(N,{children:[e.jsxs(D,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Export Data"]}),e.jsx(U,{children:"Download table data in various formats"})]}),e.jsx(w,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(s=>e.jsxs(N,{className:"border-muted",children:[e.jsx(D,{className:"pb-2",children:e.jsxs(R,{className:"text-sm font-medium flex items-center justify-between",children:[e.jsx("span",{className:"truncate",children:s.name.replace(/_/g," ").replace(/civora nexus /,"")}),e.jsx($,{variant:"secondary",children:s.totalCount.toLocaleString()})]})}),e.jsx(w,{className:"space-y-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{size:"sm",variant:"outline",onClick:()=>l(s.name,"csv"),className:"flex-1",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"CSV"]}),e.jsxs(_,{size:"sm",variant:"outline",onClick:()=>l(s.name,"json"),className:"flex-1",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),"JSON"]})]})})]},s.name))})})]})})},Je=()=>{const{user:c,userRole:v}=je(),{toast:r}=B(),[l,x]=b.useState({tables:[],loading:!0,error:null,selectedTable:null}),h=["profiles","admin_logs","otp_verifications","employees","interns","company_project","leadership_team","civora_nexus_partner","civora_nexus_companies","civora_nexus_company_contacts","civora_nexus_company_addresses","civora_nexus_bank_details","civora_nexus_documents","civora_nexus_social_links","contact_submissions","consultation_requests","collaboration_requests","investment_inquiries","partners_inquiries","saas_project_requests","technical_consultations","innovation_lab_applications","internship_applications","join_lab_forms","event_registrations","support_tickets","salary_inquiries","scheduled_calls","upcoming_events","email_history","jobs","applications","contact_messages","recycle_bin"],a=async(i,d,p,u,j)=>{if(c)try{await T.rpc("log_admin_action",{p_admin_id:c.id,p_action:i,p_table_name:d,p_record_id:p,p_old_data:u,p_new_data:j,p_ip_address:"browser_request",p_user_agent:navigator.userAgent})}catch(g){console.error("Error logging admin action:",g)}},s=async()=>{if(v!=="super_admin"){x(i=>({...i,error:"Access denied",loading:!1}));return}try{x(d=>({...d,loading:!0,error:null}));const i=[];for(const d of h)try{const{data:p,error:u,count:j}=await T.from(d).select("*",{count:"exact"}).range(0,9);if(u&&!u.message.includes("permission denied")){console.warn(`Error fetching data for table ${d}:`,u);continue}const g=p&&p.length>0?Object.keys(p[0]):[];i.push({name:d,columns:g,data:p||[],totalCount:j||0})}catch(p){console.warn(`Error processing table ${d}:`,p),i.push({name:d,columns:[],data:[],totalCount:0})}x(d=>({...d,tables:i,loading:!1})),await a("dashboard_accessed")}catch(i){x(d=>({...d,error:i.message,loading:!1})),r({title:"Error",description:i.message||"Failed to fetch dashboard data",variant:"destructive"})}},t=async(i,d)=>{try{const{data:p,error:u}=await T.from(i).insert(d).select().single();if(u)throw u;if(!p)throw new Error("Failed to create record - no data returned");const j=p,g=["id","ID","uuid","record_id","company_id","bank_id","contact_id","address_id","document_id","social_id"];let L;for(const y of g)if(y in j&&j[y]!=null){L=j[y];break}let k;if(L)k=String(L);else{const y=Object.values(j)[0];k=typeof y=="string"||typeof y=="number"?String(y):"unknown"}return await a("create_record",i,k,null,j),await s(),r({title:"Success",description:`Record created in ${i}`,variant:"default"}),j}catch(p){throw r({title:"Error",description:p.message||"Failed to create record",variant:"destructive"}),p}},o=async(i,d,p,u)=>{try{const{data:j,error:g}=await T.from(i).update(p).eq("id",d).select().single();if(g)throw g;return await a("update_record",i,d,u,j),await s(),r({title:"Success",description:`Record updated in ${i}`,variant:"default"}),j}catch(j){throw r({title:"Error",description:j.message||"Failed to update record",variant:"destructive"}),j}},f=async(i,d,p)=>{try{const{error:u}=await T.from(i).delete().eq("id",d);if(u)throw u;await a("delete_record",i,d,p,null),await s(),r({title:"Success",description:`Record deleted from ${i}`,variant:"default"})}catch(u){throw r({title:"Error",description:u.message||"Failed to delete record",variant:"destructive"}),u}},S=async(i,d=0,p=10)=>{try{const{data:u,error:j,count:g}=await T.from(i).select("*",{count:"exact"}).range(d*p,(d+1)*p-1);if(j)throw j;return{data:u||[],count:g||0}}catch(u){return r({title:"Error",description:u.message||"Failed to fetch table data",variant:"destructive"}),{data:[],count:0}}};return b.useEffect(()=>{c&&v==="super_admin"&&s()},[c,v]),{dashboardState:l,createRecord:t,updateRecord:o,deleteRecord:f,fetchTableData:S,fetchTables:s,logAction:a,setSelectedTable:i=>x(d=>({...d,selectedTable:i}))}},me=b.memo(()=>{const[c,v]=b.useState("overview"),{dashboardState:r,fetchTables:l}=Je(),{toast:x}=B(),h=M.useCallback(async()=>{try{await l(),x({title:"Dashboard Refreshed",description:"Data has been updated successfully",variant:"default"})}catch(t){x({title:"Refresh Failed",description:t.message||"Failed to refresh dashboard",variant:"destructive"})}},[l,x]),a=M.useMemo(()=>r.tables.reduce((t,o)=>t+o.totalCount,0),[r.tables]),s=M.useCallback(()=>{switch(c){case"overview":return e.jsx(oe,{tables:r.tables,loading:r.loading});case"tables":return e.jsx(He,{tables:r.tables,loading:r.loading});case"analytics":return e.jsx(Ie,{tables:r.tables,loading:r.loading});case"exports":return e.jsx(Ke,{tables:r.tables,loading:r.loading});default:return e.jsx(oe,{tables:r.tables,loading:r.loading})}},[c,r.tables,r.loading]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Super Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive system management and analytics"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(_,{variant:"outline",onClick:h,disabled:r.loading,children:[e.jsx(Be,{className:`h-4 w-4 mr-2 ${r.loading?"animate-spin":""}`}),"Refresh"]}),e.jsxs($,{variant:"secondary",children:[a.toLocaleString()," Total Records"]})]})]}),e.jsx(Me,{tables:r.tables,loading:r.loading}),e.jsxs(fe,{value:c,onValueChange:v,children:[e.jsxs(ge,{className:"grid w-full grid-cols-4",children:[e.jsx(O,{value:"overview",children:"Overview"}),e.jsx(O,{value:"tables",children:"Table Management"}),e.jsx(O,{value:"analytics",children:"Analytics"}),e.jsx(O,{value:"exports",children:"Export Tools"})]}),e.jsx("div",{className:"mt-6",children:s()})]})]})});me.displayName="SuperAdminDashboard";const bs=()=>e.jsx(me,{});export{bs as default};
