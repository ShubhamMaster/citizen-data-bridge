import{c as C,r as c,q as b,j as e,B as n,C as u,v as j,w as p,x as v,s as m}from"./index-COc_9EsS.js";import{I as P}from"./input-CtDZ1l8n.js";import{L as T}from"./label-Dwl52tZZ.js";import{B as E}from"./badge-jxMiL_t9.js";import{T as S,a as F,b as g,c as l,d as B,e as d}from"./table-BBQAnNUa.js";import{K as L}from"./key-CYPoqoP7.js";import{R}from"./refresh-cw-DDwdgVYR.js";import{E as z}from"./eye-off-Ccxjz4Hh.js";import{E as D}from"./eye-BWg0lIGw.js";import{T as H}from"./trash-2-CCkRIFkE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=C("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Z=()=>{const[N,w]=c.useState([]),[x,t]=c.useState(!0),[h,y]=c.useState(""),[f,_]=c.useState({}),{toast:r}=b(),o=async()=>{try{t(!0);const{data:s,error:a}=await m.from("api_keys").select("*").order("created_at",{ascending:!1});if(a)throw a;const I=(s||[]).map(i=>({...i,key_name:i.key_name||"Unnamed Key",api_key_masked:i.api_key.substring(0,8)+"..."+i.api_key.substring(i.api_key.length-4),api_key_full:i.api_key}));w(I)}catch{r({title:"Error",description:"Failed to fetch API keys",variant:"destructive"})}finally{t(!1)}};c.useEffect(()=>{o()},[]);const k=async()=>{if(!h.trim()){r({title:"Error",description:"Please enter a name for the API key",variant:"destructive"});return}try{t(!0);const{data:s,error:a}=await m.functions.invoke("generate-api-key",{body:{key_name:h.trim()}});if(a)throw a;r({title:"Success",description:"API key generated successfully",variant:"default"}),o(),y("")}catch(s){r({title:"Error",description:s.message||"Failed to generate API key",variant:"destructive"})}finally{t(!1)}},K=async s=>{try{t(!0);const{error:a}=await m.from("api_keys").delete().eq("id",s);if(a)throw a;r({title:"Success",description:"API key deleted successfully",variant:"default"}),o()}catch{r({title:"Error",description:"Failed to delete API key",variant:"destructive"})}finally{t(!1)}},A=s=>{_(a=>({...a,[s]:!a[s]}))};return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loader"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(L,{className:"h-8 w-8"}),"API Keys"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and generate API keys for secure access"})]}),e.jsxs(n,{onClick:o,variant:"outline",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{children:"Generate New API Key"})}),e.jsx(v,{children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center gap-4",children:[e.jsx(T,{htmlFor:"name",children:"Key Name"}),e.jsx(P,{id:"name",value:h,onChange:s=>y(s.target.value),className:"col-span-2"})]}),e.jsx(n,{onClick:k,disabled:x,children:"Generate Key"})]})})]}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{children:"API Keys"})}),e.jsx(v,{children:e.jsxs(S,{children:[e.jsx(F,{children:e.jsxs(g,{children:[e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Key"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Created At"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsx(B,{children:N.map(s=>e.jsxs(g,{children:[e.jsx(d,{className:"font-medium",children:s.key_name}),e.jsx(d,{children:f[s.id]?e.jsxs("div",{className:"flex items-center",children:[s.api_key_full,e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>navigator.clipboard.writeText(s.api_key_full||""),children:e.jsx(q,{className:"h-4 w-4"})})]}):s.api_key_masked}),e.jsx(d,{children:e.jsx(E,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsx(d,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"outline",size:"icon",onClick:()=>A(s.id),children:f[s.id]?e.jsx(z,{className:"h-4 w-4"}):e.jsx(D,{className:"h-4 w-4"})}),e.jsx(n,{variant:"destructive",size:"icon",onClick:()=>K(s.id),children:e.jsx(H,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})]})};export{Z as default};
