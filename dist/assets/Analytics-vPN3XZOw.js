import{ac as b,ar as se,r as V,q as je,j as t,B as oe,C as _,v as T,w as k,x as L,s as G}from"./index-COc_9EsS.js";import{B}from"./badge-jxMiL_t9.js";import{S as ge,a as be,b as Ae,c as we,d as X}from"./select-DRr0sP0p.js";import{T as Pe}from"./trending-up-BAW7o3Tz.js";import{D as Oe}from"./download-CpAEjvKm.js";import{R as Se}from"./refresh-cw-DDwdgVYR.js";import{F as Ce}from"./file-text-BWAGHgaU.js";import{U as Ne}from"./users-CStnP4Kw.js";import{B as De}from"./building-2-9KbUser1.js";import{C as Ee}from"./calendar-CSB8LMDL.js";import{i as _e,D as Te,f as ke,L as Q,d as Y,e as Le,A as Be,g as M,h as Re,j as te,k as Fe,l as Ie,G as Ue,m as me,n as le,u as $e,E as Ke,o as We,X as re,Y as ne,p as Me,R as Z,B as Ve,C as ce,T as ee,a as ze,P as qe,b as Ge,c as Xe}from"./PieChart-EB9GDdoi.js";import"./index-s0IQ3itP.js";import"./index-CUsEfDx6.js";import"./index-DUvJja7M.js";import"./chevron-down-Q_a8tIzl.js";import"./chevron-up-DP1NMAhj.js";var Ye=["type","layout","connectNulls","ref"],He=["key"];function $(e){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$(e)}function ue(e,n){if(e==null)return{};var a=Je(e,n),r,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)r=l[i],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Je(e,n){if(e==null)return{};var a={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(n.indexOf(r)>=0)continue;a[r]=e[r]}return a}function z(){return z=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},z.apply(this,arguments)}function de(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,r)}return a}function P(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?de(Object(a),!0).forEach(function(r){S(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):de(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function U(e){return tt(e)||et(e)||Ze(e)||Qe()}function Qe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ze(e,n){if(e){if(typeof e=="string")return ae(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ae(e,n)}}function et(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tt(e){if(Array.isArray(e))return ae(e)}function ae(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function rt(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function he(e,n){for(var a=0;a<n.length;a++){var r=n[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fe(r.key),r)}}function nt(e,n,a){return n&&he(e.prototype,n),a&&he(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function at(e,n,a){return n=H(n),it(e,pe()?Reflect.construct(n,a||[],H(e).constructor):n.apply(e,a))}function it(e,n){if(n&&($(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return st(e)}function st(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pe=function(){return!!e})()}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},H(e)}function ot(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&ie(e,n)}function ie(e,n){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},ie(e,n)}function S(e,n,a){return n=fe(n),n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function fe(e){var n=lt(e,"string");return $(n)=="symbol"?n:n+""}function lt(e,n){if($(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,n||"default");if($(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var q=function(e){function n(){var a;rt(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return a=at(this,n,[].concat(i)),S(a,"state",{isAnimationFinished:!0,totalLength:0}),S(a,"generateSimpleStrokeDasharray",function(s,o){return"".concat(o,"px ").concat(s-o,"px")}),S(a,"getStrokeDasharray",function(s,o,d){var y=d.reduce(function(A,g){return A+g});if(!y)return a.generateSimpleStrokeDasharray(o,s);for(var v=Math.floor(s/y),h=s%y,u=o-s,m=[],c=0,f=0;c<d.length;f+=d[c],++c)if(f+d[c]>h){m=[].concat(U(d.slice(0,c)),[h-f]);break}var j=m.length%2===0?[0,u]:[u];return[].concat(U(n.repeat(d,v)),U(m),j).map(function(A){return"".concat(A,"px")}).join(", ")}),S(a,"id",$e("recharts-line-")),S(a,"pathRef",function(s){a.mainCurve=s}),S(a,"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0}),a.props.onAnimationEnd&&a.props.onAnimationEnd()}),S(a,"handleAnimationStart",function(){a.setState({isAnimationFinished:!1}),a.props.onAnimationStart&&a.props.onAnimationStart()}),a}return ot(n,e),nt(n,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,s=l.points,o=l.xAxis,d=l.yAxis,y=l.layout,v=l.children,h=ke(v,Ke);if(!h)return null;var u=function(f,j){return{x:f.x,y:f.y,value:f.value,errorVal:me(f.payload,j)}},m={clipPath:r?"url(#clipPath-".concat(i,")"):null};return b.createElement(Q,m,h.map(function(c){return b.cloneElement(c,{key:"bar-".concat(c.props.dataKey),data:s,xAxis:o,yAxis:d,layout:y,dataPointFormatter:u})}))}},{key:"renderDots",value:function(r,i,l){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var o=this.props,d=o.dot,y=o.points,v=o.dataKey,h=Y(this.props,!1),u=Y(d,!0),m=y.map(function(f,j){var A=P(P(P({key:"dot-".concat(j),r:3},h),u),{},{value:f.value,dataKey:v,cx:f.x,cy:f.y,index:j,payload:f.payload});return n.renderDotItem(d,A)}),c={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(l,")"):null};return b.createElement(Q,z({className:"recharts-line-dots",key:"dots"},c),m)}},{key:"renderCurveStatically",value:function(r,i,l,s){var o=this.props,d=o.type,y=o.layout,v=o.connectNulls;o.ref;var h=ue(o,Ye),u=P(P(P({},Y(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(l,")"):null,points:r},s),{},{type:d,layout:y,connectNulls:v});return b.createElement(Le,z({},u,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,i){var l=this,s=this.props,o=s.points,d=s.strokeDasharray,y=s.isAnimationActive,v=s.animationBegin,h=s.animationDuration,u=s.animationEasing,m=s.animationId,c=s.animateNewValues,f=s.width,j=s.height,A=this.state,g=A.prevPoints,E=A.totalLength;return b.createElement(Be,{begin:v,duration:h,isActive:y,easing:u,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(N){var O=N.t;if(g){var R=g.length/o.length,D=o.map(function(w,J){var K=Math.floor(J*R);if(g[K]){var W=g[K],I=M(W.x,w.x),ye=M(W.y,w.y);return P(P({},w),{},{x:I(O),y:ye(O)})}if(c){var ve=M(f*2,w.x),xe=M(j/2,w.y);return P(P({},w),{},{x:ve(O),y:xe(O)})}return P(P({},w),{},{x:w.x,y:w.y})});return l.renderCurveStatically(D,r,i)}var F=M(0,E),p=F(O),x;if(d){var C="".concat(d).split(/[,\s]+/gim).map(function(w){return parseFloat(w)});x=l.getStrokeDasharray(p,E,C)}else x=l.generateSimpleStrokeDasharray(E,p);return l.renderCurveStatically(o,r,i,{strokeDasharray:x})})}},{key:"renderCurve",value:function(r,i){var l=this.props,s=l.points,o=l.isAnimationActive,d=this.state,y=d.prevPoints,v=d.totalLength;return o&&s&&s.length&&(!y&&v>0||!Re(y,s))?this.renderCurveWithAnimation(r,i):this.renderCurveStatically(s,r,i)}},{key:"render",value:function(){var r,i=this.props,l=i.hide,s=i.dot,o=i.points,d=i.className,y=i.xAxis,v=i.yAxis,h=i.top,u=i.left,m=i.width,c=i.height,f=i.isAnimationActive,j=i.id;if(l||!o||!o.length)return null;var A=this.state.isAnimationFinished,g=o.length===1,E=se("recharts-line",d),N=y&&y.allowDataOverflow,O=v&&v.allowDataOverflow,R=N||O,D=te(j)?this.id:j,F=(r=Y(s,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},p=F.r,x=p===void 0?3:p,C=F.strokeWidth,w=C===void 0?2:C,J=Fe(s)?s:{},K=J.clipDot,W=K===void 0?!0:K,I=x*2+w;return b.createElement(Q,{className:E},N||O?b.createElement("defs",null,b.createElement("clipPath",{id:"clipPath-".concat(D)},b.createElement("rect",{x:N?u:u-m/2,y:O?h:h-c/2,width:N?m:m*2,height:O?c:c*2})),!W&&b.createElement("clipPath",{id:"clipPath-dots-".concat(D)},b.createElement("rect",{x:u-I/2,y:h-I/2,width:m+I,height:c+I}))):null,!g&&this.renderCurve(R,D),this.renderErrorBar(R,D),(g||s)&&this.renderDots(R,W,D),(!f||A)&&Ie.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:i.curPoints}:r.points!==i.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,i){for(var l=r.length%2!==0?[].concat(U(r),[0]):r,s=[],o=0;o<i;++o)s=[].concat(U(s),U(l));return s}},{key:"renderDotItem",value:function(r,i){var l;if(b.isValidElement(r))l=b.cloneElement(r,i);else if(_e(r))l=r(i);else{var s=i.key,o=ue(i,He),d=se("recharts-line-dot",typeof r!="boolean"?r.className:"");l=b.createElement(Te,z({key:s},o,{className:d}))}return l}}])}(V.PureComponent);S(q,"displayName","Line");S(q,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ue.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});S(q,"getComposedData",function(e){var n=e.props,a=e.xAxis,r=e.yAxis,i=e.xAxisTicks,l=e.yAxisTicks,s=e.dataKey,o=e.bandSize,d=e.displayedData,y=e.offset,v=n.layout,h=d.map(function(u,m){var c=me(u,s);return v==="horizontal"?{x:le({axis:a,ticks:i,bandSize:o,entry:u,index:m}),y:te(c)?null:r.scale(c),value:c,payload:u}:{x:te(c)?null:a.scale(c),y:le({axis:r,ticks:l,bandSize:o,entry:u,index:m}),value:c,payload:u}});return P({points:h,layout:v},y)});var ct=We({chartName:"LineChart",GraphicalChild:q,axisComponents:[{axisType:"xAxis",AxisComp:re},{axisType:"yAxis",AxisComp:ne}],formatAxisMap:Me});const St=()=>{var v;const[e,n]=V.useState({}),[a,r]=V.useState(!0),[i,l]=V.useState("30"),{toast:s}=je(),o=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"],d=async()=>{var h,u,m,c,f,j,A;try{r(!0);const[g,E,N,O]=await Promise.all([G.from("contact_submissions").select("*"),G.from("profiles").select("*"),G.from("civora_nexus_companies").select("*"),G.from("upcoming_events").select("*")]),R=((h=g.data)==null?void 0:h.reduce((p,x)=>(p[x.inquiry_type||"general"]=(p[x.inquiry_type||"general"]||0)+1,p),{}))||{},D=((u=E.data)==null?void 0:u.reduce((p,x)=>{const C=new Date(x.created_at).toLocaleDateString("en-US",{month:"short",year:"numeric"});return p[C]=(p[C]||0)+1,p},{}))||{},F=((m=N.data)==null?void 0:m.reduce((p,x)=>{const C=x.industry||"Other";return p[C]=(p[C]||0)+1,p},{}))||{};n({totalForms:((c=g.data)==null?void 0:c.length)||0,totalUsers:((f=E.data)==null?void 0:f.length)||0,totalCompanies:((j=N.data)==null?void 0:j.length)||0,totalEvents:((A=O.data)==null?void 0:A.length)||0,formsByType:Object.entries(R).map(([p,x])=>({name:p,value:x})),usersByMonth:Object.entries(D).map(([p,x])=>({name:p,value:x})),companiesByIndustry:Object.entries(F).map(([p,x])=>({name:p,value:x}))})}catch(g){console.error("Error fetching analytics:",g),s({title:"Error",description:"Failed to fetch analytics data",variant:"destructive"})}finally{r(!1)}};V.useEffect(()=>{d()},[i]);const y=()=>{const h=[["Metric","Value"],["Total Forms",e.totalForms],["Total Users",e.totalUsers],["Total Companies",e.totalCompanies],["Total Events",e.totalEvents]].map(f=>f.join(",")).join(`
`),u=new Blob([h],{type:"text/csv"}),m=URL.createObjectURL(u),c=document.createElement("a");c.href=m,c.download="analytics-export.csv",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(m)};return a?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Analytics Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"Comprehensive business insights and metrics"})]})}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((h,u)=>t.jsx("div",{className:"h-24 bg-gray-200 rounded animate-pulse"},u))})]}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[t.jsx(Pe,{className:"h-8 w-8"}),"Analytics Dashboard"]}),t.jsx("p",{className:"text-muted-foreground",children:"Comprehensive business insights and metrics"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs(ge,{value:i,onValueChange:l,children:[t.jsx(be,{className:"w-32",children:t.jsx(Ae,{})}),t.jsxs(we,{children:[t.jsx(X,{value:"7",children:"Last 7 days"}),t.jsx(X,{value:"30",children:"Last 30 days"}),t.jsx(X,{value:"90",children:"Last 90 days"}),t.jsx(X,{value:"365",children:"Last year"})]})]}),t.jsxs(oe,{onClick:y,variant:"outline",children:[t.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Export"]}),t.jsxs(oe,{onClick:d,variant:"outline",children:[t.jsx(Se,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(_,{children:[t.jsx(T,{className:"pb-2",children:t.jsxs(k,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Ce,{className:"h-4 w-4"}),"Total Forms"]})}),t.jsxs(L,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.totalForms}),t.jsx(B,{variant:"secondary",children:"+12% from last month"})]})]}),t.jsxs(_,{children:[t.jsx(T,{className:"pb-2",children:t.jsxs(k,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Ne,{className:"h-4 w-4"}),"Total Users"]})}),t.jsxs(L,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.totalUsers}),t.jsx(B,{variant:"secondary",children:"+8% from last month"})]})]}),t.jsxs(_,{children:[t.jsx(T,{className:"pb-2",children:t.jsxs(k,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(De,{className:"h-4 w-4"}),"Total Companies"]})}),t.jsxs(L,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.totalCompanies}),t.jsx(B,{variant:"secondary",children:"+15% from last month"})]})]}),t.jsxs(_,{children:[t.jsx(T,{className:"pb-2",children:t.jsxs(k,{className:"text-sm font-medium flex items-center gap-2",children:[t.jsx(Ee,{className:"h-4 w-4"}),"Total Events"]})}),t.jsxs(L,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e.totalEvents}),t.jsx(B,{variant:"secondary",children:"+5% from last month"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(_,{children:[t.jsx(T,{children:t.jsx(k,{children:"Form Submissions by Type"})}),t.jsx(L,{children:t.jsx(Z,{width:"100%",height:300,children:t.jsxs(Ve,{data:e.formsByType,children:[t.jsx(ce,{strokeDasharray:"3 3"}),t.jsx(re,{dataKey:"name"}),t.jsx(ne,{}),t.jsx(ee,{}),t.jsx(ze,{dataKey:"value",fill:"#8884d8"})]})})})]}),t.jsxs(_,{children:[t.jsx(T,{children:t.jsx(k,{children:"User Registrations Over Time"})}),t.jsx(L,{children:t.jsx(Z,{width:"100%",height:300,children:t.jsxs(ct,{data:e.usersByMonth,children:[t.jsx(ce,{strokeDasharray:"3 3"}),t.jsx(re,{dataKey:"name"}),t.jsx(ne,{}),t.jsx(ee,{}),t.jsx(q,{type:"monotone",dataKey:"value",stroke:"#8884d8",strokeWidth:2})]})})})]}),t.jsxs(_,{children:[t.jsx(T,{children:t.jsx(k,{children:"Companies by Industry"})}),t.jsx(L,{children:t.jsx(Z,{width:"100%",height:300,children:t.jsxs(qe,{children:[t.jsx(Ge,{data:e.companiesByIndustry,cx:"50%",cy:"50%",labelLine:!1,label:({name:h,percent:u})=>`${h} ${(u*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:(v=e.companiesByIndustry)==null?void 0:v.map((h,u)=>t.jsx(Xe,{fill:o[u%o.length]},`cell-${u}`))}),t.jsx(ee,{})]})})})]}),t.jsxs(_,{children:[t.jsx(T,{children:t.jsx(k,{children:"Performance Summary"})}),t.jsx(L,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:"Conversion Rate"}),t.jsx(B,{variant:"default",children:"4.2%"})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:"Average Response Time"}),t.jsx(B,{variant:"default",children:"2.3 hours"})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:"Customer Satisfaction"}),t.jsx(B,{variant:"default",children:"94%"})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:"Active Projects"}),t.jsx(B,{variant:"default",children:"18"})]})]})})]})]})]})};export{St as default};
